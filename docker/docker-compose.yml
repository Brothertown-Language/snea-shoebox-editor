services:
  streamlit:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    hostname: streamlit
    ports:
      - "8501:8501"
    volumes:
      - ..:/app
    environment:
      - GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
      - GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}
    command: uv run streamlit run src/frontend/app.py

  tester:
    build:
      context: ..
      dockerfile: docker/Dockerfile.test
    volumes:
      - ..:/app
      - tester_venv:/app/.venv
      - playwright_browsers:/ms-playwright
    environment:
      - PLAYWRIGHT_BROWSERS_PATH=/ms-playwright
    depends_on:
      streamlit:
        condition: service_started

networks:
  default:
    name: snea-default

volumes:
  tester_venv:
  playwright_browsers:
